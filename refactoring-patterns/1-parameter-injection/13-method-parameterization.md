## 13. メソッドのパラメータ化

### 概要

「メソッドのパラメータ化」とは、メソッド内で生成されているオブジェクトを、外部から渡されたパラメータに置き換える手法を指します。この手法により、特定のオブジェクト生成に依存するメソッドを柔軟に変更可能にし、テストや分離を行いやすくすることができます。このリファクタリングは、コードの柔軟性やテスト容易性を向上させるための手法の一つです。

---

### 使用すべき場面

1. **テストの簡易化**: メソッドが特定のオブジェクト生成に依存している場合、そのオブジェクトをモックやスタブに差し替えたい時。
2. **コードの再利用性向上**: 同じ処理を異なるコンテキストで使用する必要がある場合。
3. **依存性の削減**: メソッド内部で依存するオブジェクトを外部から注入することで、コードの密結合を防ぐ。

---

### Javaコード例

### リファクタリング前

```java
public class TestCase {
    private TestResult m_result;

    public void run() {
        m_result = new TestResult(); // 内部でオブジェクトを生成
        try {
            setUp();
            runTest(m_result);
        } catch (Exception e) {
            m_result.addFailure(e, this);
        }
        tearDown();
    }
}

```

### リファクタリング後

```java
public class TestCase {
    private TestResult m_result;

    public void run(TestResult result) { // 外部からオブジェクトを注入
        m_result = result;
        try {
            setUp();
            runTest(m_result);
        } catch (Exception e) {
            m_result.addFailure(e, this);
        }
        tearDown();
    }

    // 元のシグネチャを維持するための委譲メソッド
    public void run() {
        run(new TestResult());
    }
}

```

---

### 手順

1. **置き換えたいメソッドを特定**: パラメータ化を必要とするメソッドを特定します。
2. **メソッドのコピー作成**: 元のメソッドを複製し、パラメータを追加して新しいメソッドを作成します。
3. **生成処理の削除とパラメータ化**: 新しいメソッドでは、内部生成を削除し、外部からオブジェクトを受け取るように変更します。
4. **元のメソッドを委譲メソッドとして残す**: 元のシグネチャを維持するために、新しいメソッドを呼び出す委譲メソッドとして残します。

---

- **考慮点**:
    - 呼び出し側のコードがやや複雑になる可能性がある。
    - 適切なパラメータ設計が求められる。