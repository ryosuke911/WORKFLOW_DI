## 14. パラメータのプリミティブ化
### **概要**

「パラメータのプリミティブ化」は、複雑なオブジェクトを関数やメソッドの引数として使用する代わりに、必要な情報を表す単純なプリミティブ型（例えば、整数や文字列など）を引数として渡すことで、コードをよりシンプルでテストしやすいものにするリファクタリング手法です。

**主な目的**:

1. **依存関係の削減**: 複雑なオブジェクトを直接利用する代わりに、必要な値だけを明示的に渡すことで依存関係を減らします。
2. **テストの容易化**: 単純なプリミティブ型のデータを用いることで、モックやスタブを用意する手間を省き、テストをシンプルにします。
3. **柔軟性の向上**: 特定のオブジェクト構造に縛られないため、コードの再利用性が高まります。

---

### **使用すべき場面**

以下のような状況で有効です：

1. **オブジェクトに過剰に依存している場合**
    - メソッドやクラスが複雑なオブジェクトを引数として受け取っているが、実際にはそのオブジェクトの一部のデータしか利用していないとき。
    - オブジェクトの変更が波及し、依存先のメソッドやクラスの修正が頻繁に発生している場合。
2. **テストが困難な場合**
    - 複雑なオブジェクトを生成するために多数の依存関係を解決しなければならない。
    - テストコードが冗長化している場合。
3. **責務を分離したい場合**
    - メソッドの責務を明確化し、特定の値に関する処理を抽出したい場合。
    - オブジェクトの構造を隠蔽し、処理の焦点を絞りたい場合。

---

### **例: パラメータのプリミティブ化**

### **変更前: 複雑なオブジェクトを利用**

```java
public class Event {
    private int duration;  // イベントの継続時間（秒）

    public Event(int duration) {
        this.duration = duration;
    }

    public int getDuration() {
        return duration;
    }
}

public class EventProcessor {
    public void processEvent(Event event) {
        // Eventオブジェクトから情報を取得して処理
        int duration = event.getDuration();
        System.out.println("Processing event with duration: " + duration);
    }
}

```

この場合、`EventProcessor`は`Event`オブジェクト全体に依存していますが、実際に必要なのは`duration`のみです。

---

### **変更後: プリミティブ型を使用**

```java
public class EventProcessor {
    public void processEvent(int duration) {
        // durationだけを利用して処理を実行
        System.out.println("Processing event with duration: " + duration);
    }
}

```

このように、`Event`オブジェクトではなく、単純な`int`型の`duration`を引数にすることで、依存関係が削減されます。

---

### **テストコード**

```java
public class EventProcessorTest {
    public static void main(String[] args) {
        EventProcessor processor = new EventProcessor();

        // テストは単純なプリミティブ値を使うだけで済む
        processor.processEvent(10);  // 10秒のイベントを処理
        processor.processEvent(30);  // 30秒のイベントを処理
    }
}

```

このように、`Event`クラスのインスタンスを用意する手間が不要になり、テストコードが簡潔になります。

---

### **パラメータのプリミティブ化のメリット**

1. **依存の削減**
    - クラスやメソッドが特定のオブジェクトの構造に依存しなくなります。これにより、オブジェクトが変更された際の影響範囲が狭くなります。
2. **テスト容易性の向上**
    - テスト時に必要なのは単純なデータ型だけなので、モックやスタブを準備する必要がなくなります。
3. **コードの簡素化**
    - メソッドの引数が簡素になり、責務が明確化されます。
4. **柔軟性の向上**
    - 再利用性が高まり、異なる状況で同じメソッドを利用しやすくなります。

---

### **注意点**

1. **情報不足のリスク**
    - 必要以上にプリミティブ化を行うと、逆にコンテキスト情報が不足する場合があります。十分に必要な情報を確保することが重要です。
2. **パラメータが増えすぎるリスク**
    - 複数のプリミティブ型を渡す必要がある場合、それらをグループ化した方が適切なこともあります。例えば、`duration`と`type`の2つを渡す場合、再び`Event`のような小さなクラスを作成するほうが良い場合もあります。

---
